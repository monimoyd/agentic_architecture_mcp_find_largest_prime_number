# agentic_architecture_mcp_find_largest_prime_number
This reposiotry I have used Agentic architecture and leveraging MCP to find largest prime number. The Agent has been built using Four Modules: Perception module, Memory Module, Decision, Action. MCP tools client and server are used for defining exposing functionalities e.g. Find Prime Numbers given a list, Find largest number from a list and Excluding a number from list. The agent also allows user to specify a preference which has been integrated with prompt.

## Perception module

This module is responsible for extracting structured information from user input using a Large Language Model (LLM) gemini-flash-2.0. It identifies the user's intent, key entities, and suggests a relevant tool hint for the Master Control Program (MCP). This structured information is crucial for the AI agent to understand the user's request and determine the appropriate course of action.

**Key Features:**

*   **LLM-Powered Extraction:** Leverages a Large Language Model (LLM) to extract intent, entities, and tool hints from user input. This allows the module to handle a wide range of natural language inputs and adapt to different user styles.
*   **Structured Output:** Returns the extracted information in a structured format using the `PerceptionResult` Pydantic model. This ensures that the information is consistent and easily accessible to other modules.
*   **Tool Hinting:** Suggests a relevant tool hint for the Master Control Program (MCP), guiding the agent towards the appropriate tool for fulfilling the user's request.
*   **Error Handling:** Includes robust error handling to catch exceptions during LLM interaction and parsing, ensuring the agent can gracefully handle unexpected situations.
*   **Customizable Prompt:** Uses a customizable prompt to guide the LLM's extraction process. This allows you to tailor the module to specific domains or tasks.


## Memory Module
This module provides a simple in-memory storage solution for managing conversational history and other relevant information within an agent. It allows for adding, retrieving, and bulk adding memory items.

Key features of this module:

 **Structured Memory Items:** Uses the `MemoryItem` class to represent individual pieces of information with associated metadata, such as type, timestamp, tool name, user query, and session ID.
**In-Memory Storage:** Provides a simple and efficient in-memory storage solution for quick access to recent information.
 **Extensible Design:** Designed to be easily extended with different storage backends (e.g., databases, vector stores) and retrieval strategies (e.g., semantic search).
**Type Hinting and Data Validation:** Leverages type hinting and Pydantic models for improved code clarity, maintainability, and data integrity.

## Decision Module

This module is responsible for generating a plan of action for an AI agent based on its perception of the environment and its memory of past interactions. It uses a Large Language Model (LLM) to decide whether to call a tool or provide a final answer to the user.

**Key Features:**

*   **Plan Generation:** Uses an LLM to generate a plan of action, which can be either a tool call or a final answer.
*   **Structured Input:** Takes structured input in the form of `PerceptionResult` and a list of `MemoryItem` objects.
*   **Tool Integration:** Supports the integration of external tools by providing tool descriptions to the LLM.
*   **Loop Adherence:** Enforces a strict loop structure for decision-making, ensuring that the agent either calls a tool or provides a final answer at each step.
*   **Error Handling:** Includes error handling to catch exceptions during LLM interaction and returns a default "unknown" answer in case of failure.

## Action Module

This module is responsible for parsing and executing tool calls generated by the decision-making component of an AI agent. It translates the structured tool call information into executable actions, interacts with external tools, and returns the results.

**Key Features:**

*   **Tool Call Parsing:** Parses the `FUNCTION_CALL` string generated by the LLM into a tool name and a dictionary of arguments.
*   **Tool Execution:** Executes the specified tool with the provided arguments using the MCP (Master Control Program) client session.
*   **Result Handling:** Handles the result returned by the tool, extracting the relevant information and formatting it for further processing.
*   **Error Handling:** Provides robust error handling to catch exceptions during parsing and execution, ensuring the agent can gracefully handle unexpected situations.
*   **Flexibility:** Supports various argument types, including strings, numbers, lists, and nested dictionaries.

  ## Data Models Module

This module defines a set of Pydantic models used to structure the input and output data for various tools within an AI agent framework. These models ensure data consistency, type safety, and facilitate data validation, contributing to the overall robustness and maintainability of the system.

**Key Features:**

*   **Pydantic-Based:** Leverages Pydantic for data validation and settings management, providing a clear and concise way to define data structures.
*   **Type Hinting:** Employs type hinting for improved code readability and maintainability, making it easier to understand the expected data types for each field.
*   **Tool-Specific Models:** Defines separate models for each tool, ensuring that the input and output data is tailored to the specific requirements of that tool.

  ## Prime Number Tools Module

This module defines a set of tools for performing prime number calculations, designed to be used within an AI agent framework. It leverages the MCP (Master Control Program) to expose these tools for use by the agent's decision-making process.

**Key Features:**

*   **MCP Integration:** Seamlessly integrates with the MCP framework, allowing the tools to be easily registered and accessed by AI agents.
*   **Prime Number Calculation:** Provides a tool for identifying prime numbers within a given list.
*   **Largest Number Identification:** Offers a tool for finding the largest number within a given list.
*   **Number Exclusion:** Includes a tool for excluding a specific number from a list of numbers.
*   **Error Debugging Prompt:** Defines a prompt for debugging errors encountered during tool execution.
*   **Flexible Input/Output:** Uses Pydantic models for defining the input and output structures of the tools, ensuring data validation and type safety.

  ## Prime Number Agent Module
This module provides a collection of mathematical tools focused on prime number operations, designed for seamless integration with AI agent frameworks. By leveraging the Master Control Program (MCP), these tools can be easily exposed and utilized by intelligent agents for problem-solving and reasoning tasks.

**Core Functionality:**

This module offers a suite of functions that perform essential prime number calculations, including identifying prime numbers within a list, determining the largest number in a set, and excluding specific numbers from a given list. These tools are designed to be modular and reusable, allowing agents to leverage them in various contexts.


**Key Features:**

*   **MCP Integration:** Seamlessly integrates with the MCP framework, enabling easy registration and access to the tools by AI agents. This allows agents to dynamically discover and utilize these mathematical functions as needed.
*   **Prime Number Identification:** Provides a dedicated tool for efficiently identifying prime numbers within a given list of integers. This tool utilizes an optimized algorithm to quickly determine the primality of each number.
*   **Largest Number Determination:** Offers a tool for quickly identifying the largest number within a given list of integers. This tool provides a simple and efficient way for agents to find the maximum value in a set.
*   **Number Exclusion:** Includes a tool for excluding a specific number from a list of integers. This tool allows agents to filter and manipulate data sets based on specific criteria.
*   **Error Debugging Prompt:** Defines a prompt for debugging errors encountered during tool execution. This prompt provides valuable information to the agent, enabling it to diagnose and resolve issues effectively.
*   **Flexible Input/Output with Pydantic:** Employs Pydantic models to define the input and output structures of the tools, ensuring data validation, type safety, and improved code maintainability. This approach promotes consistency and reduces the risk of errors.

## Interaction with Prime Number agentic tool

```

agent) C:\solution>python prime_number_agent.py
üßë What do you want to solve today? ‚Üí find the largest prime number from the list: [ 15, 23, 7, 29, 4, 18, 15]
Please provide your preference: Exclude number 29 from prime numbers list and find maximum
[agent] Starting agent...
[agent] Current working directory: C:\eag_v1\session6\assignment_final
Connection established, creating session...
[agent] Session created, initializing...
[agent] MCP session initialized
Available tools: ['find_prime_numbers', 'find_largest', 'exclude_number']
Requesting tool list...
[09:14:49] [agent] 3 tools loaded
[09:14:49] [loop] Step 1 started
[09:14:55] [perception] LLM output: {"intent": "find largest prime excluding a specific number", "entities": ["15", "23", "7", "29", "4", "18", "15", "29", "prime", "largest", "maximum"], "tool_hint": "Calculator"}
[09:14:55] [perception] Intent: find largest prime excluding a specific number, Tool hint: Calculator
[09:14:55] [memory] Retrieved 0 relevant memories
[09:14:57] [plan] LLM output: First, I need to identify the prime numbers from the given list.
FUNCTION_CALL: find_prime_numbers|numbers=[15, 23, 7, 29, 4, 18, 15]
[09:14:57] [plan] Plan generated: FUNCTION_CALL: find_prime_numbers|numbers=[15, 23, 7, 29, 4, 18, 15]
[09:14:57] [parser] Parsed: find_prime_numbers ‚Üí {'input': {'a': [15, 23, 7, 29, 4, 18, 15]}}
[09:14:57] [tool] ‚öôÔ∏è Calling 'find_prime_numbers' with: {'input': {'a': [15, 23, 7, 29, 4, 18, 15]}}
[09:14:57] [tool] ‚úÖ find_prime_numbers result: ['{"result": [23, 7, 29]}']
[09:14:57] [tool] find_prime_numbers returned: ['{"result": [23, 7, 29]}']
[09:14:57] [loop] Step 2 started
[09:14:58] [perception] LLM output: {"intent": "Find the largest prime number excluding 29", "entities": ["29", "prime number", "largest"], "tool_hint": "Calculator"}
[09:14:58] [perception] Intent: Find the largest prime number excluding 29, Tool hint: Calculator
[09:14:58] [memory] Retrieved 1 relevant memories
[09:14:59] [plan] LLM output: The problem is to find the largest prime number from the list [15, 23, 7, 29, 4, 18, 15] excluding 29.
The previous output indicates that the prime numbers in the list are [23, 7, 29].
Now, I need to find the largest number from the prime numbers excluding 29.
First I need to exclude 29.
FUNCTION_CALL: exclude_number|numbers=[23, 7, 29]|exclude=29
[09:14:59] [plan] Plan generated: FUNCTION_CALL: exclude_number|numbers=[23, 7, 29]|exclude=29
[09:14:59] [parser] Parsed: exclude_number ‚Üí {'input': {'a': [23, 7, 29], 'b': 29}}
[09:14:59] [tool] ‚öôÔ∏è Calling 'exclude_number' with: {'input': {'a': [23, 7, 29], 'b': 29}}
[09:14:59] [tool] ‚úÖ exclude_number result: ['{"result": [23, 7]}']
[09:14:59] [tool] exclude_number returned: ['{"result": [23, 7]}']
[09:14:59] [loop] Step 3 started
[09:15:00] [perception] LLM output: {"intent": "find the largest prime number excluding 29", "entities": ["29", "prime number", "largest"], "tool_hint": "Calculator"}
[09:15:00] [perception] Intent: find the largest prime number excluding 29, Tool hint: Calculator
[09:15:00] [memory] Retrieved 2 relevant memories
[09:15:02] [plan] LLM output: The problem is to find the largest prime number from the list [15, 23, 7, 29, 4, 18, 15] excluding 29. The previous steps identified [23, 7] as prime numbers after excluding 29. Now I need to find the largest number from the list [23, 7].
FUNCTION_CALL: find_largest|numbers=[23, 7]
[09:15:02] [plan] Plan generated: FUNCTION_CALL: find_largest|numbers=[23, 7]
[09:15:02] [parser] Parsed: find_largest ‚Üí {'input': {'a': [23, 7]}}
[09:15:02] [tool] ‚öôÔ∏è Calling 'find_largest' with: {'input': {'a': [23, 7]}}
[09:15:02] [tool] ‚úÖ find_largest result: ['{"result": 23}']
[09:15:02] [tool] find_largest returned: ['{"result": 23}']
[09:15:02] [agent] Agent session complete.

```


